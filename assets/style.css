/* =========================
   Rodzaki — style.css
   
   (stability pass: eliminates gradient-layer mismatch artifacts / vertical banding)
   ========================= */

/* reset */
* { box-sizing: border-box; }
html, body { height: 100%; }
body { margin: 0; }

/* ====== theme tokens ====== */
:root{
  --ink: #2a2a2a;
  --muted: #6b6b6b;

  --stone: #e9e5dc;
  --paper: #f2efe6;

  /* geometry */
  --corniceH: 96px;
  --stepH: 160px;

  --colW: 86px;
  --upperPlinthW: 120px;     /* single per column */
  --lowerPlinthW: 260px;     /* shared per pair */

  --colGap: 26px;

  --capH: 28px;              /* cap touches cornice */
  --upperPlinthH: 22px;
  --lowerPlinthH: 34px;

  /* rounding */
  --roundBig: 22px;
  --roundMed: 16px;

  /* placement tuning */
  --pairInset: 40px;         /* overall inset for pairs */
  --capOverlap: 2px;         /* tiny overlap into cornice */

  /* derived (avoid fractional calc chains on some GPU paths) */
  --plinthEdge: 65px;        /* = lowerPlinthW * .25 (260 * .25) */
}

/* ====== base typography ====== */
body{
  font: 16px/1.6 system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
  color: var(--ink);
  background: var(--paper);
}

h1{
  margin: 0 0 12px;
  font-size: 30px;
  letter-spacing: .4px;
}

p{ margin: 10px 0; color: var(--muted); }
a{ color: #0b4f6c; text-decoration: none; }
a:hover{ text-decoration: underline; }

/* layout */
main{
  max-width: 980px;
  margin: 0 auto;
  padding: 32px 20px;
}

header{ text-align: center; }

/* =========================
   PUBLICATIONS — PORTAL
   ========================= */

body.publications-directory{
  background-color: var(--paper);

  /* anchor coordinates (computed once) */
  --shaftH: calc(100vh - var(--corniceH) - var(--stepH));
  --halfUpperDelta: calc((var(--upperPlinthW) - var(--colW)) / 2);

  --leftOuterX: calc(var(--plinthEdge) + var(--pairInset));
  --leftInnerX: calc(var(--leftOuterX) + var(--colW) + var(--colGap));

  --rightOuterX: calc(100vw - var(--plinthEdge) - var(--pairInset) - var(--colW));
  --rightInnerX: calc(var(--rightOuterX) - var(--colW) - var(--colGap));

  --capY: calc(var(--corniceH) - var(--capH) + var(--capOverlap));
  --upperPlinthY: calc(100% - var(--stepH) - var(--upperPlinthH));
  --lowerPlinthY: calc(100% - var(--stepH));

  /* deltas for box-shadow cloning */
  --dxLeftInner: calc(var(--leftInnerX) - var(--leftOuterX));
  --dxRightInner: calc(var(--rightInnerX) - var(--leftOuterX));
  --dxRightOuter: calc(var(--rightOuterX) - var(--leftOuterX));

  --capX0: calc(var(--leftOuterX) - var(--halfUpperDelta)); /* cap/plinth centered over shaft */
  --dxCapLeftInner: calc((var(--leftInnerX) - var(--halfUpperDelta)) - var(--capX0));
  --dxCapRightInner: calc((var(--rightInnerX) - var(--halfUpperDelta)) - var(--capX0));
  --dxCapRightOuter: calc((var(--rightOuterX) - var(--halfUpperDelta)) - var(--capX0));

  background-image:

  /* cornice (2 layers) */
  linear-gradient(180deg, rgba(255,255,255,.85), rgba(0,0,0,.12)),
  repeating-linear-gradient(90deg, rgba(0,0,0,.06) 0 10px, rgba(255,255,255,.18) 10px 20px),

  /* steps (2 layers) */
  linear-gradient(180deg, rgba(0,0,0,.14), rgba(255,255,255,.35)),
  repeating-linear-gradient(0deg, rgba(0,0,0,.06) 0 2px, rgba(255,255,255,.16) 2px 14px),

  /* LEFT PAIR — LOWER PLINTH (3 pieces) */
  radial-gradient(circle at left 50%, rgba(255,255,255,.55), rgba(0,0,0,.18)),
  radial-gradient(circle at right 50%, rgba(255,255,255,.55), rgba(0,0,0,.18)),
  linear-gradient(180deg, rgba(255,255,255,.55), rgba(0,0,0,.18)),

  /* RIGHT PAIR — LOWER PLINTH (3 pieces) */
  radial-gradient(circle at left 50%, rgba(255,255,255,.55), rgba(0,0,0,.18)),
  radial-gradient(circle at right 50%, rgba(255,255,255,.55), rgba(0,0,0,.18)),
  linear-gradient(180deg, rgba(255,255,255,.55), rgba(0,0,0,.18)),

  /* parchment */
  linear-gradient(180deg, rgba(255,255,255,.45), rgba(0,0,0,.04));

  background-size:
  100% var(--corniceH),
  100% var(--corniceH),

  100% var(--stepH),
  100% var(--stepH),

  var(--roundBig) var(--lowerPlinthH),
  var(--roundBig) var(--lowerPlinthH),
  calc(var(--lowerPlinthW) - (var(--roundBig) * 2)) var(--lowerPlinthH),

  var(--roundBig) var(--lowerPlinthH),
  var(--roundBig) var(--lowerPlinthH),
  calc(var(--lowerPlinthW) - (var(--roundBig) * 2)) var(--lowerPlinthH),

  100% 100%;

  background-position:
  0 0,
  0 0,

  0 100%,
  0 100%,

  /* LEFT LOWER PLINTH (3 pieces) */
  var(--plinthEdge) var(--lowerPlinthY),
  calc(var(--plinthEdge) + var(--lowerPlinthW) - var(--roundBig)) var(--lowerPlinthY),
  calc(var(--plinthEdge) + var(--roundBig)) var(--lowerPlinthY),

  /* RIGHT LOWER PLINTH (3 pieces) */
  calc(100% - var(--plinthEdge) - var(--lowerPlinthW)) var(--lowerPlinthY),
  calc(100% - var(--plinthEdge) - var(--roundBig)) var(--lowerPlinthY),
  calc(100% - var(--plinthEdge) - var(--lowerPlinthW) + var(--roundBig)) var(--lowerPlinthY),

  0 0;

  background-repeat: no-repeat;
}

/* ====== v25 stability overlays (replaces huge multi-layer list)
   - shafts are one element + 3 clones via box-shadow
   - caps & upper plinths are separate elements + clones
   This removes layer-count mismatch risk and eliminates the full-screen vertical banding seen in Chrome/Windows GPU paths.
   ====== */

/* shafts (with fluting) */
body.publications-directory::before{
  content: "";
  position: fixed;
  top: var(--corniceH);
  left: var(--leftOuterX);
  width: var(--colW);
  height: var(--shaftH);
  pointer-events: none;
  z-index: 0;

  /* shaft body + fluting */
  background-image:
    linear-gradient(180deg, rgba(255,255,255,.70), rgba(0,0,0,.10)),
    repeating-linear-gradient(90deg, rgba(0,0,0,.06) 0 7px, rgba(255,255,255,.18) 7px 14px);
  background-size: 100% 100%, 100% 100%;
  background-repeat: no-repeat;

  /* clone 3 more shafts */
  box-shadow:
    var(--dxLeftInner) 0 0 0 rgba(0,0,0,0),
    var(--dxRightInner) 0 0 0 rgba(0,0,0,0),
    var(--dxRightOuter) 0 0 0 rgba(0,0,0,0);

  /* force stable compositing */
  transform: translateZ(0);
  will-change: transform;
}

/* We need the clones to carry the same paint as the base; box-shadow alone doesn’t replicate background.
   So we instead use filter drop-shadows to “stamp” the element.
   (This is a GPU-stable trick and avoids 28 background layers.) */
@supports (filter: drop-shadow(0 0 0 #000)){
  body.publications-directory::before{
    box-shadow: none;
    filter:
      drop-shadow(var(--dxLeftInner) 0 0 rgba(0,0,0,1))
      drop-shadow(var(--dxRightInner) 0 0 rgba(0,0,0,1))
      drop-shadow(var(--dxRightOuter) 0 0 rgba(0,0,0,1));
  }
}

/* caps + upper plinths (one element; uses real border-radius; then stamped to other columns) */
body.publications-directory::after{
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;

  /* base “column ornament” box */
  --ornW: var(--upperPlinthW);

  /* draw a cap + upper plinth as two rounded rectangles via gradients */
  background-image:
    /* CAP */
    linear-gradient(180deg, rgba(255,255,255,.65), rgba(0,0,0,.12)),
    /* UPPER PLINTH */
    linear-gradient(180deg, rgba(255,255,255,.55), rgba(0,0,0,.18));
  background-size:
    var(--ornW) var(--capH),
    var(--ornW) var(--upperPlinthH);
  background-position:
    var(--capX0) var(--capY),
    var(--capX0) var(--upperPlinthY);
  background-repeat: no-repeat;

  /* round them using masks */
  -webkit-mask-image:
    radial-gradient(circle at var(--roundMed) calc(var(--capH)/2), #000 98%, transparent 100%),
    radial-gradient(circle at calc(100% - var(--roundMed)) calc(var(--capH)/2), #000 98%, transparent 100%),
    linear-gradient(#000, #000),

    radial-gradient(circle at var(--roundMed) calc(var(--upperPlinthH)/2), #000 98%, transparent 100%),
    radial-gradient(circle at calc(100% - var(--roundMed)) calc(var(--upperPlinthH)/2), #000 98%, transparent 100%),
    linear-gradient(#000, #000);
  -webkit-mask-size:
    var(--ornW) var(--capH),
    var(--ornW) var(--capH),
    var(--ornW) var(--capH),

    var(--ornW) var(--upperPlinthH),
    var(--ornW) var(--upperPlinthH),
    var(--ornW) var(--upperPlinthH);
  -webkit-mask-position:
    var(--capX0) var(--capY),
    var(--capX0) var(--capY),
    var(--capX0) var(--capY),

    var(--capX0) var(--upperPlinthY),
    var(--capX0) var(--upperPlinthY),
    var(--capX0) var(--upperPlinthY);
  -webkit-mask-repeat: no-repeat;

  /* stamp to the other 3 columns */
  transform: translateZ(0);
  will-change: transform;
}

@supports (filter: drop-shadow(0 0 0 #000)){
  body.publications-directory::after{
    filter:
      drop-shadow(var(--dxCapLeftInner) 0 0 rgba(0,0,0,1))
      drop-shadow(var(--dxCapRightInner) 0 0 rgba(0,0,0,1))
      drop-shadow(var(--dxCapRightOuter) 0 0 rgba(0,0,0,1));
  }
}

/* content centering */
body.publications-directory main{
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding-top: calc(var(--corniceH) + 24px);
  padding-bottom: calc(var(--stepH) + 24px);
  position: relative;
  z-index: 1;
}

/* optional: slightly soften the “stone” so banding is less visible on some monitors */
@media (prefers-reduced-transparency: no-preference){
  body.publications-directory{
    background-color: var(--paper);
  }
}
